# 14장 프로젝트에서 테스트

## 빠른 도입
- 단위 테스트와 같은 실천법을 배우는 것은 끊임 없는 경계를 요구한다.
- 테스트 없이 코드를 작성하는 것은 **단기간** 에만 생산적이다.
- 급조한 코드를 변경하는데 더 많은 시간이 들고 코드도 이해하기 어려워 진다.
- 단위 테스트는 품질 통제의 일부가 된다.
- 단위 테스트가 어떻게 팀의 습관의 일부가 될 수 있을지 토론해 보라

## 팀과 같은편 되기
- 단위 테스트에 접근하는 방식은, 개발자 마다 매우 다르다.
- 어떤 개발자 들은 TDD 를 주장하고, 어떤 개발자는 테스트가 필요하다고 느낀 부분에만 테스트를 작성한다.
- 팀이 같은 편이 되는것이 주요하며, 모든것에 동의하지 못하더라도 어떤 것에는 동의하고 합의점을 늘려가는 방향으로 시작해야 한다.

### 단위 테스트 표준 만들기
- 개발자들이 어떤 것이 모든 사람의 시간을 많이 낭비하게 한다고 느끼는가 ?
- 모두가 빠르게 동의할 수 있는 단순한 표준은 무엇인가 ?
- 초창기에 표준화 해 해야할 목록
  - 코드를 체크인하기 전 어떤 테스트를 실행해야 하는가
  - 테스트 클래스와 메소드의 이름 짓는 방식
  - 햄크레스트 혹은 전통적인 단언 사용 여부
  - AAA 사용 여부
  - 선호하는 목 도구 선택
  - 체크인 테스트를 실행할 때 콘솔에 출력을 허용할 지 여부
  - 단위 테스트 스위트에서 느린 테스트를 분명하게 식별하고 막을 방법

### 리뷰로 표준 점수 높이기
- 표준을 준수하는 것은 쉽지 않다.
- 팀은 대다수 동료에게 압박을 조금 가할 필요가 있다.
- 리뷰 세션을 통해 단위 테스트 작성자가 다른 팀원들에게 피드백을 요청할 수 있다.
- 페이건 검사 (Fagan Inspections) 기법을 사용해 리뷰 절차를 공식화 할 수 있다.
- 또 다른 장치는 PR 을 활용하는 것

### 짝 프로그래밍을 이용한 리뷰
- 짝 프로그래밍은 두 번째 사람의 눈으로 시작부터 품질이 좋은 코드를 만들 수 있다는 희망을 줄 수 있다.
- 짝 프로그래밍을 하게 되면 단위 테스트 가치는 더 높아진다.

## 지속적 통합으로 수렴
- 단위 테스트는 모든 문제를 해결해 주지는 않지만 일종의 표준이다.
- 코드에 대한 어떤 변경이 집합적인 테스트를 망가트릴 수는 없다.
- 단위 테스트를 팀 차원 표준으로 보려면 공유 저장소가 필요하다.
- 지속적인 통합 (CI) 가 핊요하다.
- CI 는 코드를 더 자주 통합하고, 이를 매번 검증하는 것을 의미한다.
- 코드를 변경점과 합쳤을 때 동작하지 않는다는 것을 빨리 알수록 팀 성과는 더 좋아진다.
- CI 서버가 어떤 가치를 제공하려면 빌드가 단위 테스트를 함께 수행해야 한다.
- 자바와 잘 동작하는 CI 도구들은 매우 다양하다.
  - 허드슨
  - 젠킨스
  - 팀시티
  - 앤트힐
  - 크루즈콘트롤
  - 빌드봇
  - 뱀부
  - 등..

## 코드 커버리지
- 코드 커버리지는 단위 테스트가 실행한 코드의 전체 퍼센트를 측정하는 것
- 어떤 도구들은 분기 커버리지를 측정한다.
- 각 조건문은 분기를 의미

### 커버리지는 어느정도 여야 하는가 ?
- 커버리지 개념은 속임수를 써야만 100%에 도달할 수 있다는 함정이 있다.
- 코드를 작성하고 습관적으로 단위테스트를 작성하는 팀은, 비교적 쉽게 70%의 커버리지를 달성한다.
- 커버리지 밖의 코드는 대부분을 결함을 갖고 있는데, 그 이유는 커버되지 않는 코드가 많은 결함을 숨기기 마련

### 커버리지 100%는 정말 좋은가 ?
- 설계가 좋을수록 테스트 작성도 쉬워진다.
- 의지가 반영된 좋은 설계는 여러분을 더 적은 결함으로 이끄는 100% 커버리지에 도달할 수 있게 할 것이다.
- 커버리지 퍼센트 자체는 오도될 수 있다.

### 코드 커버리지의 가치
- 코드 커버리지 숫자는 큰 의미가 없다.
- 하지만 커버리지의 추세는 중요하다.
- 시간이 지나면서 커버리지 퍼센트는 높아져야지, 내려가선 안된다.